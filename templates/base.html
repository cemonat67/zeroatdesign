<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}FFSP Dashboard{% endblock %}</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">
    

    
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <!-- Brand -->
            <a class="navbar-brand" href="{{ url_for('index') }}" onclick="window.location.href='/'">
                <div class="brand-icon">
                    <img src="{{ url_for('static', filename='images/zero-design-logo.svg') }}" alt="Zero@Design Logo" class="logo-img">
                </div>
            </a>

            <!-- Navbar Toggle -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Navigation Links -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Navigation Section Title -->
                <div class="nav-section-title">
                    <span>Sayfalar — Navigasyon</span>
                </div>
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('index') }}" data-page="dashboard">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('benchmark') }}" data-page="benchmark">
                            <i class="fas fa-chart-bar"></i> Benchmark
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('style_card') }}" data-page="style_card">
                            <i class="fas fa-id-card"></i> Style Card
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('collection') }}" data-page="collection">
                            <i class="fas fa-layer-group"></i> Collection
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('dpp') }}" data-page="dpp">
                            <i class="fas fa-certificate"></i> DPP/NFT
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('blockchain_status') }}" data-page="blockchain">
                            <i class="fas fa-cube"></i> Blockchain
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('database') }}" data-page="database">
                            <i class="fas fa-database"></i> Database
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('data_entry') }}" data-page="data_entry">
                            <i class="fas fa-edit"></i> Veri Giriş
                        </a>
                    </li>
                </ul>

                <!-- Action Buttons -->
                <div class="navbar-actions">
                    <!-- Language Selector -->
                    <div class="lang">
                        <span class="pill" data-lang="tk">TK</span>
                        <span class="pill" data-lang="tr">TR</span>
                        <span class="pill active" data-lang="en" style="background: var(--brand); color: white;">EN</span>
                    </div>
                </div>
            </div>
            
            <!-- Page Header Section - Integrated with Navigation -->
            <div class="integrated-header">
                {% block page_header %}
                <div class="page-header-content text-center">
                    <h1 class="page-title">Zero@Design Dashboard — Eco-Design @ Source</h1>
                    <p class="page-subtitle">Sürdürülebilir tasarım ve karbon ayak izi ölçümü için gelişmiş analitik platform</p>
                </div>
                {% endblock %}
            </div>
        </div>
    </nav>



    <!-- Main Content -->
    <main class="main-content">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container-fluid">
            <div class="footer-content">
                <div class="footer-brand">
                    <i class="fas fa-leaf"></i>
                    <span>Zero@Design</span>
                </div>
                <div class="footer-text">
                    Sürdürülebilir tasarım ve karbon ayak izi ölçümü için gelişmiş analitik platform
                </div>
                <div class="footer-links">
                    <a href="#" class="footer-link">Gizlilik</a>
                    <a href="#" class="footer-link">Şartlar</a>
                    <a href="#" class="footer-link">Destek</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Navigation Active State Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get current page from URL
            const currentPath = window.location.pathname;
            
            // Remove active class from all nav links
             document.querySelectorAll('.nav-link').forEach(item => {
                 item.classList.remove('active');
             });
            
            // Add active class to current page
            let currentPageFound = false;
            
            // Check navigation links first
            document.querySelectorAll('.nav-link[data-page]').forEach(link => {
                const href = link.getAttribute('href');
                if (href === currentPath || (currentPath === '/' && href === '/')) {
                    link.classList.add('active');
                    currentPageFound = true;
                }
            });
            
            // If not found in nav links, check action buttons
             if (!currentPageFound) {
                 // Action buttons removed, so this section is no longer needed
             }
            
            // If still not found and we're on home page, activate dashboard
            if (!currentPageFound && currentPath === '/') {
                const dashboardLink = document.querySelector('[data-page="dashboard"]');
                if (dashboardLink) {
                    dashboardLink.classList.add('active');
                }
            }

            // Language Selector Functionality
            const languagePills = document.querySelectorAll('.lang .pill');
            
            languagePills.forEach(pill => {
                pill.addEventListener('click', function() {
                    const selectedLang = this.getAttribute('data-lang');
                    
                    // Remove active class from all pills
                    languagePills.forEach(p => {
                        p.classList.remove('active');
                        p.style.background = '';
                        p.style.color = '';
                    });
                    
                    // Add active class to clicked pill
                    this.classList.add('active');
                    this.style.background = 'var(--brand)';
                    this.style.color = 'white';
                    
                    // Store selected language in localStorage
                    localStorage.setItem('selectedLanguage', selectedLang);
                    
                    // Apply language changes
                    applyLanguage(selectedLang);
                    
                    // Show notification
                    showLanguageNotification(selectedLang);
                });
            });

            // Load saved language on page load
            const savedLanguage = localStorage.getItem('selectedLanguage') || 'en';
            applyLanguage(savedLanguage);
            
            // Set active pill based on saved language
            languagePills.forEach(pill => {
                if (pill.getAttribute('data-lang') === savedLanguage) {
                    pill.classList.add('active');
                    pill.style.background = 'var(--brand)';
                    pill.style.color = 'white';
                } else {
                    pill.classList.remove('active');
                    pill.style.background = '';
                    pill.style.color = '';
                }
            });
        });

        function applyLanguage(lang) {
            // Language translations object
            const translations = {
                'tr': {
                    'dashboard': 'Kontrol Paneli',
                    'collection': 'Koleksiyon',
                    'style_card': 'Stil Kartı',
                    'analyze': 'Analiz',
                    'benchmark': 'Benchmark',
                    'optimize': 'Optimizasyon',
                    'report': 'Rapor',
                    'export': 'Dışa Aktar',
                    'analytics': 'Analitik',
                    'settings': 'Ayarlar',
                    'dpp': 'DPP/NFT',
                    'blockchain': 'Blockchain',
                    'database': 'Veritabanı'
                },
                'en': {
                    'dashboard': 'Dashboard',
                    'collection': 'Collection',
                    'style_card': 'Style Card',
                    'analyze': 'Analyze',
                    'benchmark': 'Benchmark',
                    'optimize': 'Optimize',
                    'report': 'Report',
                    'export': 'Export',
                    'analytics': 'Analytics',
                    'settings': 'Settings',
                    'dpp': 'DPP/NFT',
                    'blockchain': 'Blockchain',
                    'database': 'Database'
                },
                'tk': {
                    'dashboard': 'Dashboard',
                    'collection': 'Collection',
                    'style_card': 'Style Card',
                    'analyze': 'Analyze',
                    'benchmark': 'Benchmark',
                    'optimize': 'Optimize',
                    'report': 'Report',
                    'export': 'Export',
                    'analytics': 'Analytics',
                    'settings': 'Settings',
                    'dpp': 'DPP/NFT',
                    'blockchain': 'Blockchain',
                    'database': 'Database'
                }
            };

            // Apply translations to navigation items
            const navLinks = document.querySelectorAll('.nav-link[data-page]');
            navLinks.forEach(link => {
                const page = link.getAttribute('data-page');
                if (translations[lang] && translations[lang][page]) {
                    const textElement = link.querySelector('i').nextSibling;
                    if (textElement) {
                        textElement.textContent = ' ' + translations[lang][page];
                    }
                }
            });

            // Update page title and subtitle based on language
            const pageTitle = document.querySelector('.page-title');
            const pageSubtitle = document.querySelector('.page-subtitle');
            
            if (pageTitle && pageSubtitle) {
                if (lang === 'tr') {
                    pageTitle.textContent = 'Zero@Design Kontrol Paneli — Kaynakta Eko-Tasarım';
                    pageSubtitle.textContent = 'Sürdürülebilir tasarım ve karbon ayak izi ölçümü için gelişmiş analitik platform';
                } else if (lang === 'en') {
                    pageTitle.textContent = 'Zero@Design Dashboard — Eco-Design @ Source';
                    pageSubtitle.textContent = 'Advanced analytics platform for sustainable design and carbon footprint measurement';
                } else if (lang === 'tk') {
                    pageTitle.textContent = 'Zero@Design Dashboard — Eco-Design @ Source';
                    pageSubtitle.textContent = 'Advanced analytics platform for sustainable design and carbon footprint measurement';
                }
            }
        }

        function showLanguageNotification(lang) {
            const langNames = {
                'tr': 'Türkçe',
                'en': 'English',
                'tk': 'Türkmence'
            };
            
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--brand);
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                z-index: 9999;
                font-size: 14px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                transition: all 0.3s ease;
            `;
            notification.textContent = `Dil değiştirildi: ${langNames[lang]}`;
            
            document.body.appendChild(notification);
            
            // Remove notification after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>